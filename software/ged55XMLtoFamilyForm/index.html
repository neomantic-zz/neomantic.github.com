<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>ged55XMLtoFamilyForm.xsl</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <style type="text/css">
.command {
   display: block;
	font-family: monospace;
	border: thin black solid;
	padding: 1em;
	background-color: #E0E0E0;
}
code.literal,.filename,.email {
    font-family: monospace;
    display: inline;
    border: none;
    padding: 0;
}
pre.screen {
    font-family: monospace;
    padding: .5em;
}
p.title {
    display: inline;
    font-size: small;
}
p.title b {
    font-style: normal;
}
.figure-contents {
    border: thin black dotted;
    background-color: #E6E6E6;
}
</style>
  </head>
  <body>
    <div class="article" lang="en-US" xml:lang="en-US">
      <div class="titlepage">
        <div><div><h2 class="title"><a id="id2496608"></a>ged55XMLtoFamilyForm.xsl</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Chad</span> <span class="surname">Albers</span></h3></div></div>August 12, 2008 </div>
        <hr />
      </div>
      <div class="sect1" lang="en-US" xml:lang="en-US">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a id="id2537579"></a>1. Overview</h2>
            </div>
          </div>
        </div>
        <p><code class="filename">ged55XMLtoFamilyForm.xsl</code> is an <a class="ulink" href="http://www.w3.org/Style/XSL/" target="_top">Extensible Stylesheet Language</a> (XSL) stylesheet that uses <a class="ulink" href="http://www.w3.org/TR/xslt" target="_top">XSLT</a> to transform a <a class="ulink" href="http://www.neomantic.com/gedcom55XML/" target="_top">GEDCOM 5.5 XML</a> document to a <a class="ulink" href="http://www.w3.org/TR/xsl/" target="_top">XSL-FO</a> stylesheet. This stylesheet can be converted to a <a class="ulink" href="http://www.adobe.com/devnet/pdf/pdf_reference.html" target="_top">Portable Document Format</a> (PDF) file using <a class="ulink" href="http://xmlgraphics.apache.org/fop/" target="_top">Apache's Formatting Objects Processor</a> Java application, <code class="literal">fop</code>. The pdf document resembles genealogy record keeping forms produced by <a class="ulink" href="http://www.progenealogists.com/" target="_top">ProGenealogists</a>. They specifically resemble the forms called “<a class="ulink" href="http://www.progenealogists.com/familygroup1.pdf" target="_top">Family Group Sheet Page 1</a>” and “<a class="ulink" href="http://www.progenealogists.com/familygroup2.pdf" target="_top">Family Group Sheet Page 2</a>”.</p>
        <div class="sect2" lang="en-US" xml:lang="en-US">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="id2547292"></a>1.1. Stylesheet Parameters</h3>
              </div>
            </div>
          </div>
          <p>Several parameters can be supplied to XSLT processors which affect the data included in the document and the document's “look and feel.”</p>
          <div class="sect3" lang="en-US" xml:lang="en-US">
            <div class="titlepage">
              <div>
                <div>
                  <h4 class="title"><a id="id2533427"></a>1.1.1. Output Data Parameters</h4>
                </div>
              </div>
            </div>
            <div class="itemizedlist">
              <ul type="disc">
                <li>
                  <p>IncludeIDs - accepts either 'true' or 'false' and acts as a flag to include the XREF ID numbers of family record elements (<code class="literal">FAM</code>) and the individual family member elements (<code class="literal">INDI</code>), including the spouses of children</p>
                </li>
                <li>
                  <p>IncludeDateGenerated - accepts either 'true or 'false'. If 'true', the date that the XSLT processor applied this stylesheet to a GEDCOM 5.5 XML document is included in the footer of the pdf document. This parameter relies on the <code class="literal">http://exslt.org/dates-and-times</code> extension. If the XSLT processor does not support this extension, the stylesheet may fail to be applied to the XML document. To be on the safe side, this parameter defaults to 'false.'</p>
                </li>
                <li>
                  <p>FamID - accepts the XREF ID of one <code class="literal">FAM</code> element. If this value is supplied, the stylesheet will produce a document containing only the family record whose ID makes the FamID parameter. If this parameter is not supplied, the stylesheet is applied to all <code class="literal">FAM</code> elements in the XML document. </p>
                </li>
                <li>
                  <p>SortFamilies - accepts either 'true or 'false'. If the IDs of the <code class="literal">FAM</code> elements are structured in a way that can be sorted in ascending or descending order, this parameter tells the stylesheet to sort these IDs and output the families in that order. It defaults to 'false'. </p>
                </li>
              </ul>
            </div>
          </div>
          <div class="sect3" lang="en-US" xml:lang="en-US">
            <div class="titlepage">
              <div>
                <div>
                  <h4 class="title"><a id="id2497252"></a>1.1.2. Look and Feel Parameters</h4>
                </div>
              </div>
            </div>
            <div class="itemizedlist">
              <ul type="disc">
                <li>
                  <p>BorderLineStyle - this parameter affects the style of the borders in the tables, rows, and cells. It defaults to 'solid', but could accept the following values: none, hidden, dotted, dashed, double, groove, ridge, inset, and outset. Use these values with caution. The stylesheet has been designed assuming solid borders. </p>
                </li>
                <li>
                  <p>BorderLineWidth - this parameter sets the width of the borders. It defaults to .3mm. Supply this parameter with caution. The stylesheet has been designed assuming the default value.</p>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="sect2" lang="en-US" xml:lang="en-US">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="id2497275"></a>1.2. Stylesheet Versions and Download Locations</h3>
              </div>
            </div>
          </div>
          <p>The stylesheet described in this document is version 0.1. It is a beta version.</p>
          <div class="itemizedlist">
            <ul type="disc">
              <li>
                <p>Both the stylesheet and this documentation is located at <a class="ulink" href="http://www.neomantic.com/downloads/ged55XMLtoFamilyForm-0.1/ged55XMLtoFamilyForm-0.1.tar.gz" target="_top">http://www.neomantic.com/downloads/ged55XMLtoFamilyForm-0.1/ged55XMLtoFamilyForm-0.1.tar.gz</a>. </p>
              </li>
              <li>
                <p>For verification purposes, I have signed this tar, gzipped archive with my <a class="ulink" href="http://www.gnupg.org/" target="_top">gnupg</a> public key located <a class="ulink" href="http://www.neomantic.com/gnupg/pubkey.asc" target="_top">here</a>. The signature of <code class="filename">ged55XMLtoFamilyForm-0.1.tar.gz</code> is located <a class="ulink" href="http://www.neomantic.com/downloads/ged55XMLtoFamilyForm-0.1/ged55XMLtoFamilyForm-0.1.tar.gz.sign" target="_top">here</a>.</p>
              </li>
            </ul>
          </div>
        </div>
        <div class="sect2" lang="en-US" xml:lang="en-US">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="id2497328"></a>1.3. Stylesheet License</h3>
              </div>
            </div>
          </div>
          <p>The source code is released under the <a class="ulink" href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html" target="_top">GNU General Public License Version 2</a> (GPL). The full text of this license can be found in a file called “<code class="filename">gpl-2.0</code>” in <code class="filename">ged55XMLtoFamilyForm-0.1.tar.gz</code>.</p>
        </div>
        <div class="sect2" lang="en-US" xml:lang="en-US">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="id2497357"></a>1.4. Stylesheet Updates</h3>
              </div>
            </div>
          </div>
          <p>Hyperlinks to the most up-to-date version of the stylesheet will be posted to <a class="ulink" href="http://www.neomantic.com" target="_top">http://www.neomantic.com</a>.</p>
        </div>
      </div>
      <div class="sect1" lang="en-US" xml:lang="en-US">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a id="id2497371"></a>2. Usage Instructions</h2>
            </div>
          </div>
        </div>
        <p>The process of converting a GEDCOM 5.5 file into a pdf document which resembles the <code class="literal">progenealogists.com</code> forms takes three steps.</p>
        <div class="orderedlist">
          <ol type="1">
            <li>
              <p>Convert the GEDCOM 5.5 file to a GEDCOM 5.5 XML document.</p>
            </li>
            <li>
              <p>Transform the GEDCOM 5.5 XML document to an XSL-FO stylsheet by applying the <code class="filename">ged55XMLtoFamilyForm.xsl</code> stylesheet to the XML document using an XSLT processor.</p>
            </li>
            <li>
              <p>Process the XSL-FO stylesheet using <code class="literal">fop</code>.</p>
            </li>
          </ol>
        </div>
        <p>The instructions below follow several conventions: </p>
        <div class="itemizedlist">
          <ul type="disc">
            <li>
              <p><code class="filename">family.ged</code> represents a GEDCOM 5.5 file</p>
            </li>
            <li>
              <p><code class="filename">family.xml</code> represents the <code class="filename">family.ged</code> file converted into a GEDCOM 5.5 XML document</p>
            </li>
            <li>
              <p><code class="filename">family.fo</code> represents a XSL-FO stylesheet produced by the XSLT processor that has applied the <code class="filename">ged55XMLtoFamilyForm.xsl</code> stylesheet to <code class="filename">family.xml</code></p>
            </li>
            <li>
              <p><code class="filename">family.pdf </code>represents the pdf file that resembles the progenealogist's forms</p>
            </li>
            <li>
              <p>Text sandwiched between brackets, <code class="literal">[]</code>, indicates variables that depend upon your computer's environment</p>
            </li>
          </ul>
        </div>
        <div class="sect2" lang="en-US" xml:lang="en-US">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="id2496669"></a>2.1. Convert the GEDCOM 5.5 File to a GEDCOM 5.5 XML Document</h3>
              </div>
            </div>
          </div>
          <p>To perform the conversion, use a Java application released by Michael H. Kay that converts GEDCOM 5.5 files into what he calls “<a class="ulink" href="http://homepage.ntlworld.com/michael.h.kay/gedml/" target="_top">GedML</a>” XML documents. GedML is similar to GEDCOM 5.5 XML. See this <a class="ulink" href="http://www.neomantic.com/gedcom55XML/0.1/README.html" target="_top">link</a> for details.</p>
          <div class="orderedlist">
            <ol type="1">
              <li>
                <p>Download Kay's <a class="ulink" href="http://homepage.ntlworld.com/michael.h.kay/gedml/" target="_top">source code</a> and unzip it in a location of your choosing. Remember the path to this location. It will be referred to in the last step using the placeholder <code class="literal">[path-to-gedml-classes]</code>.</p>
              </li>
              <li>
                <p>Find the files called “<code class="filename">GedcomParser.java</code>” and “<code class="filename">GedcomToXml.xsl</code>” in Kay's source code.</p>
              </li>
              <li>
                <p>Compile the file <code class="filename">GedcomParser.java</code> using your favorite Java distribution's compiler - <code class="literal">javac</code>. This will produce a class file called “<code class="filename">GedcomParser.class</code>”. The command is as follows:</p>
                <p>
                  <span class="command">
                    <strong>javac GedcomParser.java</strong>
                  </span>
                </p>
              </li>
              <li>
                <p>Download Kay's <code class="literal"><a class="ulink" href="http://saxon.sourceforge.net/" target="_top">saxon</a></code> parser, install it, and remember its location. Its location will be referred to below using the <code class="literal">[path-to-saxon]</code> placeholder. (It may already be installed on your system; in the <a class="ulink" href="http://www.debian.org" target="_top">Debian GNU/Linux distribution</a> it is located at <code class="literal">/usr/share/java/saxon.jar</code>.)</p>
              </li>
              <li>
                <p>Convert <code class="filename">family.ged</code> to <code class="filename">family.xml</code> by issuing the following command in your terminal:</p>
                <p>
                  <span class="command">
                    <strong>java -cp [path-to-saxon]/saxon.jar:[path-to-gedml-classes] com.icl.saxon.StyleSheet -x GedcomParser -o family.xml family.ged [path-to-gedml-classes]/GedcomToXml.xsl</strong>
                  </span>
                </p>
              </li>
            </ol>
          </div>
          <p>The output of this command, <code class="filename">family.xml</code>, will be a near perfect reproduction of a GEDCOM 5.5 into GEDCOM 5.5 XML. </p>
        </div>
        <div class="sect2" lang="en-US" xml:lang="en-US">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="id2496832"></a>2.2. Transform the GEDCOM 5.5 XML Document to an XSL-FO stylsheet</h3>
              </div>
            </div>
          </div>
          <p>To perform the transformation, the <code class="filename">ged55XMLtoFamilyForm.xsl</code> stylesheet must be applied to <code class="filename">family.xml</code> using an XSLT processor. I have used two command line applications to perform this transformation: <code class="literal"><a class="ulink" href="http://xmlsoft.org/XSLT/xsltproc2.html" target="_top">xsltproc</a></code> and <code class="literal">saxon</code>. <code class="literal">xsltproc</code> uses the Open Source XML parser called “<code class="literal"><a class="ulink" href="http://xmlsoft.org/" target="_top">libxml</a></code>” and is included in many GNU/Linux distributions. Saxon is the XSLT processor downloaded and used in the previous step.</p>
          <p>The <code class="filename">ged55XMLtoFamilyForm.xsl</code> stylesheet parameters described above can be supplied to both XSLT processors. Please consult their respective documentation to find out how to do so.</p>
          <p>NOTE: Both <code class="literal">xsltproc</code> and <code class="literal">saxon</code> may fail to transform extremely large GEDCOM 5.5 XML files due to either your computer's or the Java virtual machine's memory limitations. To get around these limitations, the <code class="literal">saxon</code> processor works best because Java's memory usage can be manipulated. See the instructions below.</p>
          <div class="sect3" lang="en-US" xml:lang="en-US">
            <div class="titlepage">
              <div>
                <div>
                  <h4 class="title"><a id="id2496926"></a>2.2.1. xsltproc</h4>
                </div>
              </div>
            </div>
            <p>To use <code class="filename">xsltproc</code>, issue the following command in a terminal:</p>
            <p>
              <span class="command">
                <strong>xsltproc ged55XMLtoFamilyForm.xsl family.xml &gt; family.fo</strong>
              </span>
            </p>
          </div>
          <div class="sect3" lang="en-US" xml:lang="en-US">
            <div class="titlepage">
              <div>
                <div>
                  <h4 class="title"><a id="id2497713"></a>2.2.2. SAXON</h4>
                </div>
              </div>
            </div>
            <p>To use <code class="filename">saxon</code>, issue the following command in a terminal:</p>
            <p>
              <span class="command">
                <strong>java -cp [path-to-saxon]/saxon.jar com.icl.saxon.StyleSheet -o family.fo family.xml ged55XMLtoFamilyForm.xsl</strong>
              </span>
            </p>
            <p>As mentioned above, if the <code class="filename">family.xml</code> file is extremely large, this command may fail due to Java's default memory settings. To increase the memory used by the Java's virtual machine, simply add these two flags to the command line: - “<code class="literal">-Xms512m -Xmx512m</code>”- and adjust the memory by supplying a value like 512m for each flag.</p>
          </div>
        </div>
        <div class="sect2" lang="en-US" xml:lang="en-US">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="id2497756"></a>2.3. Process the XSL-FO Stylesheet Using fop</h3>
              </div>
            </div>
          </div>
          <p>The outcome of the previous step is a XSL-FO document called <code class="filename">family.fo</code>. This file now needs to be processed by <code class="literal">fop</code> to produce <code class="filename">family.pdf</code>. To do so, follow these steps:</p>
          <div class="orderedlist">
            <ol type="1">
              <li>
                <p>Follow the <code class="literal">fop</code> “quick start” guide <a class="ulink" href="http://xmlgraphics.apache.org/fop/quickstartguide.html" target="_top">here</a> to download and install <code class="literal">fop</code> or use your GNU/Linux distribution's package management system to install it.</p>
              </li>
              <li>
                <p>Once installed, issue the following command in a terminal:</p>
                <p>
                  <span class="command">
                    <strong>fop -fo family.fo -pdf family.pdf</strong>
                  </span>
                </p>
                <p>The output of this command is the <code class="filename">family.pdf</code> file. </p>
              </li>
            </ol>
          </div>
        </div>
        <div class="sect2" lang="en-US" xml:lang="en-US">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="id2497834"></a>2.4. Sample</h3>
              </div>
            </div>
          </div>
          <p>In a directory called “<code class="literal">example</code>” included with the stylesheet and documentation are samples of the stylesheet output (a .fo file) and fop's output (a .pdf file). The genealogical data in these examples was drawn from a GEDCOM 5.5 file called “royal92.ged” which can easily be found on the Internet. It contains the genealogical history of the British Royal family. The example distributed with the source contains only one royal family.</p>
          <span class="inlinemediaobject">
           <a href="royal92pdf-page1.jpg"><img src="royal92pdf-page1.jpg" width="40%" height="40%" border="0" name="Output Sample" alt=""></a>
          </span>
        </div>
      </div>
      <div class="sect1" lang="en-US" xml:lang="en-US">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a id="id2497885"></a>3. Limitations</h2>
            </div>
          </div>
        </div>
        <div class="itemizedlist">
          <ul type="disc">
            <li>
              <p>The number of characters which <code class="literal">DATA</code> and <code class="literal">PLAC</code> elements can accept, following the GEDCOM 5.5 standard, are longer than what the pdf file can display. The stylesheet attempts to handle these situations by scaling the text and/or truncating it with ellipses. There are some circumstances, however, where the stylesheet fails to truncate the data within the limits of what can be displayed in the form.</p>
            </li>
            <li>
              <p>Processing large family trees with the stylesheet and subsequently with <code class="literal">fop</code> will likely strain your computer's resources. Significant processing power and RAM are highly recommended. The stylesheet needs to be optimized. </p>
            </li>
          </ul>
        </div>
      </div>
      <div class="sect1" lang="en-US" xml:lang="en-US">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a id="id2497933"></a>4. Documentation License</h2>
            </div>
          </div>
        </div>
        <p>This document is released under the <a class="ulink" href="http://www.gnu.org/licenses/fdl.html" target="_top">GNU Free Documentation License Version 1.2</a>. </p>
        <p>Copyright (c) C. Albers. Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free Documentation License, Version 1.2 or any later version published by the Free Software Foundation; with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts. A copy of the license is included in the section entitled "GNU Free Documentation License". </p>
        <p>The full text of this license is found in the file called “<code class="filename">fdl.txt</code>” released with <code class="filename">ged55XMLtoFamilyForm-0.1.tar.gz</code>.</p>
      </div>
      <div class="sect1" lang="en-US" xml:lang="en-US">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a id="id2497974"></a>5. Contact</h2>
            </div>
          </div>
        </div>
        <p>Please direct questions or requests for more information to <code class="email">&lt;<a class="email" href="mailto:chad@neomantic.com">chad@neomantic.com</a>&gt;</code>. Corrections, suggestions, bug reports, and patches are welcome as well.</p>
      </div>
    </div>
  </body>
</html>
